name = "iot"
main = "src/worker.ts"
compatibility_date = "2025-02-01"

[durable_objects]
bindings = [
  { name = "DEVICE_DO", class_name = "DeviceDurableObject" },
  { name = "USER_DO", class_name = "UserDurableObject" },
  { name = "WORKSPACE_DO", class_name = "WorkspaceDurableObject" },
  { name = "WORKSPACE_AUTOMATION_DO", class_name = "WorkspaceAutomationDO" },
  { name = "WORKSPACE_CLEANUP_DO", class_name = "WorkspaceCleanupDurableObject" }
]

[[migrations]]
tag = "v1"
new_classes = ["DeviceDurableObject", "UserDurableObject", "WorkspaceDurableObject", "WorkspaceAutomationDO", "WorkspaceCleanupDurableObject"]

[[r2_buckets]]
binding = "DEVICE_DATA_BUCKET"
bucket_name = "iot"

[vars]
TABLE_BUCKET_PREFIX = "iot/" # logical prefix for single-table style keys
USER_JWT_SECRET = "gW9hRut/Zb4/6VTgAryuMaK4ObufeQonLJ2v3iJCezA="
API_JWT_SECRET = "hX0jSvu/Ac5/7WUhBszuNbL5PcvgeRpoMK3w4kKDfzB="
DEVICE_JWT_SECRET = "iY1kTwv/Bd6/8XViCtuOmCM6QdwhhSpqNL4x5lLEgzC="
WORKSPACE_MASTER_JWT_SECRET = "jZ2lUxw/Ce7/9YWjDuvPnDN7ReximTqrOM5y6mMFh0D="
SUPER_MASTER_JWT_SECRET = "kA3mVyx/Df8/0ZXkEvwQoEO8SfyjoUrsPnN6z7nNGi1E="
# Email configuration (using MailChannels)
EMAIL_FROM = "noreply@thebaycity.dev"
EMAIL_FROM_NAME = "Thebaycity IoT"
APP_URL = "https://thebaycity.dev"

[triggers]
crons = ["* * * * *"]  # every minute â€“ drives schedule automations

[observability]
enabled = true
